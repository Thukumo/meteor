# Meteor

## 概要

[bolide](https://github.com/SIT-DigiCre/bolide)を~~パクった~~自分なりに書き直してみたものです。  

## 使用方法

- クライアントアプリ
    1. [リンク](https://meteor.tsukumo.f5.si)をクリックします
    2. テキストボックスにルーム名を入力します
    3. 接続ボタンを押します
    4. ルームへのリンクをコピーしたい場合、右上のボタンを押してください
- 配信用アプリ
    1. [リンク](https://meteor.tsukumo.f5.si/stream)をクリックします
    2. テキストボックスにルーム名を入力します
    3. 接続開始ボタンを押します
    4. 画面共有を開始ボタンを押します
    5. 共有したいものを選択します
    6. 共有ボタンを押します
    7. 表示されるコメントのサイズを変更したい場合、ページをリロードしてメニュー最下部にある"フォントサイズ"で調整してください。
- サーバ構築
    1. `git clone https://github.com/thukumo/meteor`
    2. `cd meteor`
    3. `docker build . -t meteor`
    4. `docker run -p 80:8080 meteor`

## bolideとの相異点

- ルームに接続しているユーザーがいる限り、サーバのメモリ上にコメントの履歴が残るようにしました。  
これにより、クライアントのリロードや再接続、ルームへの途中参加を行っても、自分が接続する前のコメントを読むことができます。  
コメント元を区別しうるデータ等は保持していないので、従来通りの感覚で使用が可能です。
- "質問"機能の廃止  
あまり使われていないように見えたので廃止しましたが、そんなこともなさそうなのでそのうち追加する可能性があります。
- APIのエンドポイント、レスポンスの形式  
履歴取得のためのエンドポイントを追加してあります。  
また、コメントをPOSTするエンドポイントを廃止し、コメントの受信, 送信共にWebSocketで行うようになりました。  
また、bolideはjsonでメッセージ内容, 質問であるかのbool値をWebSocketで送信していましたが、質問機能の廃止に伴って単純に文字列を送信するようにしています。

## APIについて

- <ドメイン名>
  - /api
    - /v1
      - /room
        - /<ルーム名>
          - /ws コメントの送受信用
          - /history 履歴の取得用

## 使用している技術スタック

クライアントWebアプリはFlutterを使用しています。ただしWeb以外でビルドしても動きません  
配信用WebアプリはPureJSです。  
バックエンドにはRust+Axumを採用しました。
